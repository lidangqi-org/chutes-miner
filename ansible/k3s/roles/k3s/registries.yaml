# 新增任务：为中国大陆网络环境配置镜像加速
    - name: Create K3s registries.yaml for China Mirror
      ansible.builtin.copy:
        dest: /etc/rancher/k3s/registries.yaml
        content: |
          mirrors:
            cr.l5d.io:
              endpoint:
                - "https://l5d.m.daocloud.io"
            docker.elastic.co:
              endpoint:
                - "https://elastic.m.daocloud.io"
            docker.io:
              endpoint:
                - "https://docker.m.daocloud.io"
                - "https://docker.1ms.run"
                - "https://ccr.ccs.tencentyun.com"
            gcr.io:
              endpoint:
                - "https://gcr.m.daocloud.io"
            ghcr.io:
              endpoint:
                - "https://ghcr.m.daocloud.io"
            k8s.gcr.io:
              endpoint:
                - "https://k8s-gcr.m.daocloud.io"
            registry.k8s.io:
              endpoint:
                - "https://k8s.m.daocloud.io"
            mcr.microsoft.com:
              endpoint:
                - "https://mcr.m.daocloud.io"
            nvcr.io:
              endpoint:
                - "https://nvcr.m.daocloud.io"
            quay.io:
              endpoint:
                - "https://quay.m.daocloud.io"
            registry.jujucharms.com:
              endpoint:
                - "https://jujucharms.m.daocloud.io"
            rocks.canonical.com:
              endpoint:
                - "https://rocks-canonical.m.daocloud.io"
        owner: root
        group: root
        mode: "0644"
